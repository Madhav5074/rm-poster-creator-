<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aditya Birla Poster Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Softer, light blue background */
        }
        .container {
            max-width: 550px; /* Slightly wider container */
            margin: auto;
        }
        canvas {
            border: 2px solid #e2e8f0;
            border-radius: 1.5rem; /* Larger radius for a softer look */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); /* Bolder shadow */
        }
        /* Hide the canvas and download link initially */
        #posterCanvas, #downloadBtn {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-6">

    <div class="container bg-white p-10 rounded-3xl shadow-2xl flex flex-col gap-8">

        <form id="posterForm" class="flex flex-col gap-6">
            <h1 class="text-4xl font-extrabold text-center text-blue-900 mb-2">Create Your RM Poster</h1>

            <div>
                <label for="rmPhoto" class="block text-sm font-semibold text-gray-700 mb-2">Upload RM Photo</label>
                <input type="file" id="rmPhoto" accept="image/*" class="w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-full file:border-0
                    file:text-sm file:font-semibold
                    file:bg-blue-50 file:text-blue-700
                    hover:file:bg-blue-100 cursor-pointer">
            </div>
            
            <div>
                <label for="rmName" class="block text-sm font-semibold text-gray-700 mb-1">RM Name</label>
                <input type="text" id="rmName" placeholder="Enter RM Name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            
            <div>
                <label for="bmName" class="block text-sm font-semibold text-gray-700 mb-1">Branch Manager Name</label>
                <input type="text" id="bmName" placeholder="Enter Branch Manager Name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <div>
                <label for="branchName" class="block text-sm font-semibold text-gray-700 mb-1">Branch Name</label>
                <input type="text" id="branchName" placeholder="Enter Branch Name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <div>
                <label for="clusterName" class="block text-sm font-semibold text-gray-700 mb-1">Cluster Name</label>
                <input type="text" id="clusterName" placeholder="Enter Cluster Name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <div>
                <label for="premium" class="block text-sm font-semibold text-gray-700 mb-1">Premium Amount</label>
                <input type="text" id="premium" placeholder="Enter Premium Amount" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <div>
                <label for="productType" class="block text-sm font-semibold text-gray-700 mb-1">Product Type</label>
                <input type="text" id="productType" placeholder="Enter Product Type" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            
            <div>
                <label for="clusterHead" class="block text-sm font-semibold text-gray-700 mb-1">Cluster Head Name</label>
                <input type="text" id="clusterHead" placeholder="Enter Cluster Head Name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <button type="submit" id="generateBtn" class="bg-gradient-to-r from-blue-600 to-blue-800 text-white font-bold py-3 rounded-lg shadow-lg hover:from-blue-700 hover:to-blue-900 transition duration-300 transform hover:scale-105">Generate Poster</button>
        </form>

        <div id="posterContainer" class="flex flex-col items-center gap-6">
            <canvas id="posterCanvas" width="1080" height="1350"></canvas>
            <button id="downloadBtn" class="bg-gradient-to-r from-green-600 to-green-800 text-white font-bold py-3 px-8 rounded-lg shadow-lg hover:from-green-700 hover:to-green-900 transition duration-300 transform hover:scale-105">Download Poster</button>
        </div>
        
    </div>

    <script>
        // Get all necessary elements from the DOM
        const posterForm = document.getElementById('posterForm');
        const posterCanvas = document.getElementById('posterCanvas');
        const ctx = posterCanvas.getContext('2d');
        const downloadBtn = document.getElementById('downloadBtn');
        
        // Define the logo URLs - please ensure these paths are correct
        const logoUrlAB = './assets/aditya-birla-logo.png';
        const logoUrlHDFC = './assets/hdfc-logo.png';

        posterForm.addEventListener('submit', function(event) {
            event.preventDefault();

            const rmPhotoInput = document.getElementById('rmPhoto');
            const file = rmPhotoInput.files[0];
            
            if (!file) {
                showMessage("Please upload an RM photo.");
                return;
            }

            const data = {
                rmName: document.getElementById('rmName').value,
                bmName: document.getElementById('bmName').value,
                branchName: document.getElementById('branchName').value,
                clusterName: document.getElementById('clusterName').value,
                premium: document.getElementById('premium').value,
                productType: document.getElementById('productType').value,
                clusterHead: document.getElementById('clusterHead').value
            };

            const reader = new FileReader();
            reader.onload = function(event) {
                const rmImage = new Image();
                rmImage.src = event.target.result;

                const logoAB = new Image();
                logoAB.src = logoUrlAB;

                const logoHDFC = new Image();
                logoHDFC.src = logoUrlHDFC;
                
                let loadedCount = 0;
                const totalToLoad = 3; 
                
                const checkIfLoaded = () => {
                    loadedCount++;
                    if (loadedCount === totalToLoad) {
                        drawPoster(rmImage, logoAB, logoHDFC, data);
                    }
                };

                rmImage.onload = checkIfLoaded;
                logoAB.onload = checkIfLoaded;
                logoHDFC.onload = checkIfLoaded;
                
                rmImage.onerror = () => { console.error("RM image failed to load."); checkIfLoaded(); };
                logoAB.onerror = () => { console.error("Aditya Birla logo failed to load."); logoAB.src = ''; checkIfLoaded(); };
                logoHDFC.onerror = () => { console.error("HDFC logo failed to load."); logoHDFC.src = ''; checkIfLoaded(); };
            };
            reader.readAsDataURL(file);
        });

        // Custom message box function to avoid alert()
        function showMessage(message) {
            const container = document.querySelector('.container');
            let messageBox = document.getElementById('messageBox');
            if (!messageBox) {
                messageBox = document.createElement('div');
                messageBox.id = 'messageBox';
                messageBox.className = 'fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50';
                messageBox.innerHTML = `
                    <div class="bg-white p-6 rounded-lg shadow-xl text-center flex flex-col items-center gap-4">
                        <p class="text-lg font-semibold text-gray-800">${message}</p>
                        <button onclick="this.parentNode.parentNode.style.display='none'" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">OK</button>
                    </div>
                `;
                document.body.appendChild(messageBox);
            } else {
                messageBox.querySelector('p').textContent = message;
                messageBox.style.display = 'flex';
            }
        }

        function drawPoster(rmImage, logoAB, logoHDFC, data) {
            // Set canvas dimensions
            const canvasWidth = 1080;
            const canvasHeight = 1350; // Increased height for a poster feel
            posterCanvas.width = canvasWidth;
            posterCanvas.height = canvasHeight;

            // 1. Background Gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, canvasHeight);
            gradient.addColorStop(0, '#e8eff5'); // A very light, formal blue
            gradient.addColorStop(0.2, '#f5f8fa'); // Lighter shade
            gradient.addColorStop(1, '#ffffff'); // White at the bottom
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);

            // 2. Logos (Updated placement and size)
            const logoMargin = 60;
            const hdfcLogoWidth = 350; // Larger HDFC logo
            const hdfcLogoHeight = (logoHDFC.complete && logoHDFC.naturalWidth > 0) ? (logoHDFC.naturalHeight / logoHDFC.naturalWidth) * hdfcLogoWidth : 0;
            if (hdfcLogoHeight > 0) {
                ctx.drawImage(logoHDFC, logoMargin, logoMargin, hdfcLogoWidth, hdfcLogoHeight);
            }

            const abLogoWidth = 280; // Slightly smaller Aditya Birla logo
            const abLogoHeight = (logoAB.complete && logoAB.naturalWidth > 0) ? (logoAB.naturalHeight / logoAB.naturalWidth) * abLogoWidth : 0;
            if (abLogoHeight > 0) {
                ctx.drawImage(logoAB, canvasWidth - abLogoWidth - logoMargin, logoMargin, abLogoWidth, abLogoHeight);
            }

            // 3. Main Titles
            ctx.textAlign = 'center';
            ctx.fillStyle = '#1a3263'; // Darker, formal blue
            ctx.font = 'bold 50px Inter, sans-serif';
            ctx.fillText("Aditya Birla's", canvasWidth / 2, 280);

            ctx.fillStyle = '#1a3263';
            ctx.font = 'bolder 80px Inter, sans-serif';
            ctx.fillText("Preferred RM", canvasWidth / 2, 370);

            // 4. RM Image (Circular)
            const imageSize = 380;
            const centerX = canvasWidth / 2;
            const centerY = 370 + 250;
            
            // Draw the shadow first so it's under the image
            ctx.save();
            ctx.beginPath();
            ctx.arc(centerX, centerY, imageSize / 2, 0, Math.PI * 2);
            ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
            ctx.shadowBlur = 20;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 15;
            ctx.fillStyle = '#ffffff'; // A temporary color for the shadow shape
            ctx.fill();
            ctx.restore(); // Reset shadow properties

            // Now, draw the actual image
            ctx.save();
            ctx.beginPath();
            ctx.arc(centerX, centerY, imageSize / 2, 0, Math.PI * 2);
            ctx.closePath();
            ctx.clip();
            ctx.drawImage(rmImage, centerX - imageSize / 2, centerY - imageSize / 2, imageSize, imageSize);
            ctx.restore();

            // 5. Gold Circle Border
            ctx.beginPath();
            ctx.arc(centerX, centerY, imageSize / 2, 0, Math.PI * 2);
            ctx.lineWidth = 18;
            ctx.strokeStyle = '#FFC423'; // A brighter, more formal gold/yellow
            ctx.stroke();

            // 6. Drawing the details text, grouped for better flow
            ctx.textAlign = 'center';
            let currentY = centerY + imageSize / 2 + 80;
            const lineHeight = 55;

            // Group 1: RM and BM Info
            ctx.fillStyle = '#4a5568'; // A softer gray for body text
            ctx.font = 'bold 32px Inter, sans-serif';
            ctx.fillText(`${data.rmName}`, canvasWidth / 2, currentY);
            ctx.font = '24px Inter, sans-serif';
            currentY += 35;
            ctx.fillText(`(RM)`, canvasWidth / 2, currentY);
            currentY += 60;

            ctx.font = 'bold 28px Inter, sans-serif';
            ctx.fillText(`Branch Manager: ${data.bmName}`, canvasWidth / 2, currentY);
            currentY += 40;
            ctx.fillText(`Branch: ${data.branchName} | Cluster: ${data.clusterName}`, canvasWidth / 2, currentY);
            currentY += 80;
            
            // Group 2: Premium with background box
            const premiumText = `Premium : â‚¹${data.premium}`;
            ctx.font = 'bold 55px Inter, sans-serif';
            const premiumTextMetrics = ctx.measureText(premiumText);
            const premiumTextWidth = premiumTextMetrics.width;
            const boxPadding = 40;
            const boxWidth = premiumTextWidth + (boxPadding * 2);
            const boxHeight = 85;
            const boxX = (canvasWidth / 2) - (boxWidth / 2);
            const boxY = currentY - 60;

            ctx.fillStyle = '#fef3e3'; // A formal, very light cream
            ctx.beginPath();
            ctx.roundRect(boxX, boxY, boxWidth, boxHeight, 15);
            ctx.fill();

            ctx.fillStyle = '#FFC423'; // Bright gold
            ctx.fillText(premiumText, canvasWidth / 2, currentY);
            currentY += 60;
            
            // Group 3: Product Type and Leadership
            ctx.fillStyle = '#4a5568';
            ctx.font = '28px Inter, sans-serif';
            ctx.fillText(`Product Type: ${data.productType}`, canvasWidth / 2, currentY);
            currentY += 100;

            ctx.font = '28px Inter, sans-serif';
            ctx.fillText(`Under the Dynamic Leadership of`, canvasWidth / 2, currentY);
            currentY += 40;
            ctx.font = 'bold 32px Inter, sans-serif';
            ctx.fillText(`${data.clusterHead} Sir/Ma'am`, canvasWidth / 2, currentY);

            // Show the canvas and download button
            posterCanvas.style.display = 'block';
            downloadBtn.style.display = 'block';
            posterForm.style.display = 'none';
        }

        downloadBtn.addEventListener('click', function() {
            const imageDataUrl = posterCanvas.toDataURL('image/png');
            const downloadLink = document.createElement('a');
            downloadLink.href = imageDataUrl;
            downloadLink.download = `aditya-birla-poster.png`;
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
        });
    </script>
</body>
</html>

